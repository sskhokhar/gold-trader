---
analyze_market_sentiment:
  description: >-
    You are called only after a deterministic event trigger has fired for GLD.
    Input includes a feature snapshot and macro proxy returns.
    Return only a JSON object matching MarketSentimentReport schema with:
    report_id, symbol, generated_at, regime, greed_score, sentiment_score, rationale.
    Rules:
    - Keep rationale concise and concrete.
    - sentiment_score must be in [-1, 1].
    - greed_score must be in [0, 100].
  expected_output: >-
    Strict JSON for MarketSentimentReport. No markdown. No extra keys.
  agent: market_sentiment_analyst

compose_strategy_intent:
  description: >-
    Create one StrategyIntent from feature snapshot + MarketSentimentReport context.
    Current UTC timestamp is provided as {current_utc_iso}; use this as the time anchor.
    Intent TTL seconds is provided as {intent_ttl_seconds}.
    Return only strict JSON matching StrategyIntent schema with:
    intent_id, symbol, side, entry_type, entry_price, sl, tp, qty_hint,
    confidence, regime, generated_at, expires_at, invalidation_reason, cancel_after_sec.
    Rules:
    - Use symbol GLD.
    - generated_at must be near {current_utc_iso}.
    - expires_at must be greater than generated_at and no more than {intent_ttl_seconds} seconds after generated_at.
    - For BUY: sl < entry_price < tp.
    - For SELL: tp < entry_price < sl.
    - cancel_after_sec must be 30.
  expected_output: >-
    Strict JSON for StrategyIntent. No markdown. No extra keys.
  agent: strategy_composer
  context:
    - analyze_market_sentiment
